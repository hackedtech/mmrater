console.log("I'm Working");
var codeForm = document.getElementById("codeForm");
function createCode(){
	var storyInput = document.getElementById("storyInput");
	var scrInput = document.getElementById("scrInput");
	var dirInput = document.getElementById("dirInpur");
	var perfInput = document.getElementById("perfInput");
	var dOne = document.getElementById("dOne").value;
	var dTwo = document.getElementById("dTwo").value;
	var dthree = document.getElementById("dthree").value;
	var dFour = document.getElementById("dFour").value;
	var execInput = document.getElementById("execInput").value;
	var	mmStatic = '<div class="separatormm" id="mmRating"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous" /><div id="mm_rating_widget"><div class="w3-container mainRater"><div class="w3-container w3-center myscheme"><div class="w3-container top_hed"><section><h3 id="IsMess">Mess</h3><h3 id="IsMarvellous">Marvellous</h3></section><br><br><br><section><div id="ratingMeter" style="background:#fff;border-radius:50px" class="w3-center"><div class="ratingMeter w3-center w3-display-container"><span id="percentage_calc" class="w3-display-middle"></span></div></div></section></div></div><div class="w3-container"><table class="w3-table w3-bordered"><tr><td id="dataOne">STORY</td><td id="data_rating_story" class="w3-right-align"><span id="story_stars" class="stars"></span> <span id="numerical-rating-story"></span></td></tr><tr><td id="dataTwo">SCREENPLAY</td><td id="data_rating_screenplay" class="w3-right-align"><span id="story_screenplay" class="stars"></span> <span id="numerical-rating-screenplay"></span></td></tr><tr><td id="dataThree">DIRECTION</td><td id="data_rating_direction" class="w3-right-align"><span id="story_direction" class="stars"></span> <span id="numerical-rating-direction"></span></td></tr><tr><td id="dataFour">PERFORMANCE</td><td id="data_rating_performance" class="w3-right-align"><span id="story_performance" class="stars"></span> <span id="numerical-rating-performance"></span></td></tr></table></div><div class="w3-container w3-center" id="avgrater"><h1 id="average_numerical"></h1><span id="story_avgCriteria" class="stars"></span><br><span>AVERAGE RATING</span></div></div></div></div>';
	var	mmCSS = '<style type="text/css">#mm_rating_widget{display:none;min-width:360px;width:100%}.mainRater .myscheme{background:#000000;color:#fff;height:110px}.mainRater .top_hed h3:nth-child(1){float:left;padding:5.25px;margin:15px 0;font-weight:900;text-transform:uppercase;transition:.4s ease}.mainRater .top_hed h3:nth-child(2){float:right;padding:5.25px;margin:15px 0;font-weight:900;text-transform:uppercase;transition:.4s ease}.mainRater .ratingMeter{width:0%;height:24px;background:0 0;color:#fff;border-radius:50px;transition:.4s ease}.mainRater .ratingMeter #percentage_calc{font-family:Roboto,sans-serif}.mainRater #avgrater{background:#000000;color:#fff;height:120px}.mainRater #avgrater #average_numerical,span{font-family:Roboto,sans-serif}.mainRater table td{font-weight:700}#average_numerical{margin:10px 0;color:#fff}@media all and (min-width:360px) and (max-width:680px){.separatormm{display:flex;justify-content:center;}#mm_rating_widget{width:auto;}}</style>';
	var mmBackend = "<script id='mmBackend' type='text/javascript'>/*\n   Developed By Krunchtalks Media for Krunchtalks Media \n   Dependecies: W3.css,JQuery\n   Developed By Tausif Alam\n   Â©2021, Krunchtalks Media\n*/\nfunction mmVersion(version){\n\t\t\tversion = \"mmRatingAPI: v\" + 1.1;\n\t\t\treturn version;\n}\nif (window.matchMedia(\"(max-width: 340px)\").matches){\n   document.write(\"<code>Your Device Is No Longer Supported With MovieRatingAPI</code>\")\n}else{\n\tfunction mmRating(exec,story,screenplay,direction,performance,dataOne,dataTwo,dataThree,dataFour){\n\t/*\n\t\tvariable definations\n\t\t1. exec -> boolean -> true/false\n\t\t2. story -> number -> number\n\t\t3. screenplay -> number -> number\n\t\t4. direction -> number -> number\n\t\t5. performance -> number -> number\n\t\tlet rTotal = story+screenplay+direction+performance;\n\t\tlet avgCriteria = rTotal/4 //gives number between 0-5 (0 & 5 inclusive)\n\t\tlet t_dataOne = document.querySelector(\"#dataOne\");\n\t\tlet t_dataTwo = document.querySelector(\"#dataTwo\");\n\t\tlet t_dataThree = document.querySelector(\"#dataThree\");\n\t\tlet t_dataFour = document.querySelector(\"#dataFour\");\n\t\tlet percentage_calc = document.querySelector(\"#percentage_calc\");\n\t\tlet mm_rating_widget = document.querySelector(\"#mm_rating_widget\");\n\t\tlet ratingMeter = document.querySelector(\".ratingMeter\");\n\t\tlet data_rating_story = document.querySelector(\"#data_rating_story\");\n\t\tlet rTotal = story+screenplay+direction+performance;\n\t\tlet avgCriteria = rTotal/4 //gives number between 0-5 (0 & 5 inclusive)\n\t\tlet IsMess = document.querySelector(\"#IsMess\");\n\t\tlet IsMarvellous = document.querySelector(\"#IsMarvellous\");\n\t\tlet myscheme = document.querySelector(\".myscheme\");\n\t\tlet avgrater = document.querySelector(\"#avgrater\");\n\t\tlet nume_one_story = document.querySelector(\"#numerical-rating-story\");\n\t\tlet nume_one_screenplay = document.querySelector(\"#numerical-rating-screenplay\");\n\t\tlet nume_one_direction = document.querySelector(\"#numerical-rating-direction\");\n\t\tlet nume_one_performance = document.querySelector(\"#numerical-rating-performance\");\n\t\tlet average_numerical = document.querySelector(\"#average_numerical\");\n\t*/\t\n\tlet t_dataOne = document.querySelector(\"#dataOne\");\n\tlet t_dataTwo = document.querySelector(\"#dataTwo\");\n\tlet t_dataThree = document.querySelector(\"#dataThree\");\n\tlet t_dataFour = document.querySelector(\"#dataFour\");\n\tlet percentage_calc = document.querySelector(\"#percentage_calc\");\n\tlet mm_rating_widget = document.querySelector(\"#mm_rating_widget\");\n\tlet ratingMeter = document.querySelector(\".ratingMeter\");\n\tlet data_rating_story = document.querySelector(\"#data_rating_story\");\n\tlet rTotal = story+screenplay+direction+performance;\n\tlet avgCriteria = rTotal/4 //gives number between 0-5 (0 & 5 inclusive)\n\tlet IsMess = document.querySelector(\"#IsMess\");\n\tlet IsMarvellous = document.querySelector(\"#IsMarvellous\");\n\tlet myscheme = document.querySelector(\".myscheme\");\n\tlet avgrater = document.querySelector(\"#avgrater\");\n\tlet nume_one_story = document.querySelector(\"#numerical-rating-story\");\n\tlet nume_one_screenplay = document.querySelector(\"#numerical-rating-screenplay\");\n\tlet nume_one_direction = document.querySelector(\"#numerical-rating-direction\");\n\tlet nume_one_performance = document.querySelector(\"#numerical-rating-performance\");\n\tlet average_numerical = document.querySelector(\"#average_numerical\");\n\tif (exec == true){\n\t\t//initailize widget\n\t\t    mm_rating_widget.style.display = \"block\";\n        ratingMeter.style.width = avgCriteria*20 + \"%\";\n        percentage_calc.innerHTML = (avgCriteria*20).toFixed(1) + \"%\";\n        nume_one_story.innerHTML = story.toFixed(1) + \"/5\";\n        nume_one_screenplay.innerHTML = screenplay.toFixed(1) + \"/5\";\n        nume_one_direction.innerHTML = direction.toFixed(1) + \"/5\";\n        nume_one_performance.innerHTML = performance.toFixed(1) + \"/5\";\n        average_numerical.innerHTML = avgCriteria.toFixed(1);\n    //tabledata custom text\n    if (dataOne){\n       t_dataOne.innerHTML = dataOne;\n    }\n    if (dataTwo){\n    \tt_dataTwo.innerHTML = dataTwo;\n    }\n    if (dataThree){\n    \tt_dataThree.innerHTML = dataThree;\n    }\n    if (dataFour){\n    \tt_dataFour.innerHTML = dataFour;\n    }\n    //stars for story rating\n        \t// Round to nearest half\n  story = Math.round(story * 2) / 2;\n  var output_story = [];\n\n  // Append all the filled whole stars\n  for (var st = story; st >= 1; st--)\n    output_story.push('<i class=\"fa fa-star\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // If there is a half a star, append it\n  if (st == .5) output_story.push('<i class=\"fa fa-star-half-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // Fill the empty stars\n  for (let st = (5 - story); st >= 1; st--)\n    output_story.push('<i class=\"fa fa-star-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\t\n  let story_stars = document.querySelector(\"#story_stars\").innerHTML = output_story.join('');\n        //screenplay for story rating\n        \t// Round to nearest half\n  screenplay = Math.round(screenplay * 2) / 2;\n  var output_screenplay = [];\n\n  // Append all the filled whole stars\n  for (var scr = screenplay; scr >= 1; scr--)\n    output_screenplay.push('<i class=\"fa fa-star\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // If there is a half a star, append it\n  if (scr == .5) output_screenplay.push('<i class=\"fa fa-star-half-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // Fill the empty stars\n  for (let scr = (5 - screenplay); scr >= 1; scr--)\n    output_screenplay.push('<i class=\"fa fa-star-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\t\n  let story_screenplay = document.querySelector(\"#story_screenplay\").innerHTML = output_screenplay.join('');\n  //direction for story rating\n        \t// Round to nearest half\n  direction = Math.round(direction * 2) / 2;\n  var output_direction = [];\n\n  // Append all the filled whole stars\n  for (var dir = direction; dir >= 1; dir--)\n    output_direction.push('<i class=\"fa fa-star\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // If there is a half a star, append it\n  if (dir == .5) output_direction.push('<i class=\"fa fa-star-half-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // Fill the empty stars\n  for (let dir = (5 - direction); dir >= 1; dir--)\n    output_direction.push('<i class=\"fa fa-star-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\t\n  let story_direction = document.querySelector(\"#story_direction\").innerHTML = output_direction.join('');\n  //performance for story rating\n        \t// Round to nearest half\n  performance = Math.round(performance * 2) / 2;\n  var output_performance = [];\n\n  // Append all the filled whole stars\n  for (var perfo = performance; perfo >= 1; perfo--)\n    output_performance.push('<i class=\"fa fa-star\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // If there is a half a star, append it\n  if (perfo == .5) output_performance.push('<i class=\"fa fa-star-half-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // Fill the empty stars\n  for (let perfo = (5 - performance); perfo >= 1; perfo--)\n    output_performance.push('<i class=\"fa fa-star-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\t\n  let story_performance = document.querySelector(\"#story_performance\").innerHTML = output_performance.join('');\n    //avgCriteria for story rating\n        \t// Round to nearest half\n  avgMeter = Math.round(avgCriteria * 2) / 2;\n  var output_avgCriteria = [];\n\n  // Append all the filled whole stars\n  for (var avg = avgMeter; avg >= 1; avg--)\n    output_avgCriteria.push('<i class=\"fa fa-star\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // If there is a half a star, append it\n  if (avg == .5) output_avgCriteria.push('<i class=\"fa fa-star-half-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\n  // Fill the empty stars\n  for (let avg = (5 - avgMeter); avg >= 1; avg--)\n    output_avgCriteria.push('<i class=\"fa fa-star-o\" aria-hidden=\"true\" style=\"color: #ffb400;\"></i>&nbsp;');\n\t\n  let story_avgCriteria = document.querySelector(\"#story_avgCriteria\").innerHTML = output_avgCriteria.join('');    \n        if(avgCriteria*20 <= 79){\n         if (avgCriteria*20 <= 45){\t\n        \tmyscheme.style.backgroundColor = \"#000000\";\n        \tavgrater.style.backgroundColor = \"#000000\";\n        \tratingMeter.style.backgroundColor = \"#ff0000\";\n        \tIsMess.style.color = \"#ff0000\";\n        \tIsMarvellous.style.color = \"#ffffff\";\n        \tIsMarvellous.fontSize = \"24px\";\n        \tif (x.matches){\n        \tIsMess.style.fontSize = \"24px\";\n           }else{\n           \tIsMess.style.fontSize = \"34px\";\n           }\n        \t// yes it is a mess\n        }else{\n        \tconsole.log(\"Madhyam darje ka hai!\");\n        \tmyscheme.style.backgroundColor = \"#000000\";\n        \tavgrater.style.backgroundColor = \"#000000\";\n        \tratingMeter.style.backgroundColor = \"#ffb400\";\n        \tIsMess.style.color = \"#ffffff\";\n        \tIsMess.style.fontSize = \"24px\";\n        \tIsMarvellous.style.fontSize = \"24px\"\n        \tIsMarvellous.style.color = \"#ffffff\";\n        \t// madhyam darje ka hai\n        }\n        }else if (avgCriteria*20 >= 80){\n        \tmyscheme.style.backgroundColor = \"#000000\";\n        \tavgrater.style.backgroundColor = \"#000000\";\n        \tratingMeter.style.backgroundColor = \"#ffb400\";\n        \tIsMess.style.color = \"#ffffff\";\n        \tIsMess.style.fontSize = \"24px\";\n        \tIsMarvellous.style.color = \"#ffb400\";\n        \tif (x.matches){\n        \tIsMarvellous.style.fontSize = \"24px\";\n           }else{\n           \t IsMarvellous.style.fontSize = \"34px\";\n           }\n        \t// yes it is Marvellous\n        }\n         return true;\n\t}\n\telse{\n\t\tconsole.log(\"mmRatingAPI: false\");\n\t\tmm_rating_widget.style.display = \"none\";\n\t\treturn false;\n\t}\n}\nmmRating(x);\nvar x = window.matchMedia(\"(max-width: 700px)\")\nx.addListener(mmRating) // Attach listener function on state changes\n}</script>";
	var mmRatingAPIinit = `<script id="mmRatingAPIinit" type="text/javascript">mmRating(${execInput},${storyInput.value},${scrInput.value},${dirInput.value},${perfInput.value},'${dOne.toString()}','${dTwo.toString()}','${dthree.toString()}','${dFour.toString()}');</script>`;
	var copycode = document.getElementById("copycode");
		if (!codeForm.checkValidity()){
			console.log(codeForm.validationMessage);
			return false;
		}else{
           //let generatedCode =  window.prompt("Copy/paste these codes where you want to use it", mmStatic+mmCSS+mmBackend+mmRatingAPIinit);
           let codeGenerated =  mmStatic+mmCSS+mmBackend+mmRatingAPIinit;
           copycode.value = codeGenerated;
           copycode.select();
		}
}
codeForm.onsubmit = function ()
 { 
   // nirastra bhava :)
   return false;
}
function copycode(){
	let copycode = document.getElementById("copycode");
    copycode.select();
    document.execCommand("copy");
    document.getElementById("alertCopy").style.display = "block";
    setTimeout(function(){
    	document.getElementById("alertCopy").style.display = "none";
    },5000);
}